use std::{
    error::Error,
    io,
    time::{Duration, Instant},
};

use crossterm::{
    event::{self, DisableMouseCapture, EnableMouseCapture, Event, KeyCode},
    execute,
    terminal::{disable_raw_mode, enable_raw_mode, EnterAlternateScreen, LeaveAlternateScreen},
};
use ratatui::prelude::*;
use tui_candlestick_chart::{Candle, CandleStickChart, CandleStickChartState, Interval};

struct App {
    candles: Vec<Candle>,
    state: CandleStickChartState,
}

impl App {
    fn new() -> Self {
        Self {
            candles: vec![
                Candle::new(1703976900000, 42184.08, 42191.01, 42184.07, 42191.01).unwrap(),
                Candle::new(1703976960000, 42191.01, 42191.01, 42190.96, 42190.97).unwrap(),
                Candle::new(1703977020000, 42190.96, 42190.97, 42123.95, 42124.50).unwrap(),
                Candle::new(1703977080000, 42124.51, 42161.10, 42124.50, 42158.65).unwrap(),
                Candle::new(1703977140000, 42158.65, 42158.65, 42079.97, 42132.73).unwrap(),
                Candle::new(1703977200000, 42132.73, 42161.40, 42102.88, 42133.85).unwrap(),
                Candle::new(1703977260000, 42133.84, 42162.37, 42118.04, 42141.10).unwrap(),
                Candle::new(1703977320000, 42141.11, 42174.66, 42127.08, 42168.24).unwrap(),
                Candle::new(1703977380000, 42168.25, 42197.54, 42161.61, 42197.53).unwrap(),
                Candle::new(1703977440000, 42197.53, 42210.86, 42182.83, 42189.22).unwrap(),
                Candle::new(1703977500000, 42189.22, 42220.42, 42189.22, 42220.41).unwrap(),
                Candle::new(1703977560000, 42220.42, 42231.10, 42220.41, 42220.52).unwrap(),
                Candle::new(1703977620000, 42220.52, 42240.52, 42215.49, 42240.52).unwrap(),
                Candle::new(1703977680000, 42240.52, 42241.24, 42227.47, 42227.48).unwrap(),
                Candle::new(1703977740000, 42227.48, 42233.77, 42221.10, 42221.11).unwrap(),
                Candle::new(1703977800000, 42221.10, 42221.11, 42201.10, 42206.16).unwrap(),
                Candle::new(1703977860000, 42206.15, 42227.56, 42193.66, 42193.66).unwrap(),
                Candle::new(1703977920000, 42193.67, 42202.42, 42185.00, 42202.41).unwrap(),
                Candle::new(1703977980000, 42202.41, 42224.58, 42202.41, 42224.57).unwrap(),
                Candle::new(1703978040000, 42224.58, 42230.70, 42224.57, 42230.69).unwrap(),
                Candle::new(1703978100000, 42230.70, 42238.29, 42224.52, 42227.99).unwrap(),
                Candle::new(1703978160000, 42227.99, 42234.00, 42217.56, 42228.75).unwrap(),
                Candle::new(1703978220000, 42228.75, 42257.19, 42228.74, 42257.18).unwrap(),
                Candle::new(1703978280000, 42257.18, 42260.02, 42257.18, 42260.02).unwrap(),
                Candle::new(1703978340000, 42260.01, 42278.00, 42260.01, 42270.43).unwrap(),
                Candle::new(1703978400000, 42270.43, 42295.61, 42270.43, 42293.75).unwrap(),
                Candle::new(1703978460000, 42293.75, 42293.76, 42272.00, 42272.00).unwrap(),
                Candle::new(1703978520000, 42272.00, 42272.01, 42250.00, 42250.00).unwrap(),
                Candle::new(1703978580000, 42250.00, 42254.04, 42246.83, 42254.04).unwrap(),
                Candle::new(1703978640000, 42254.04, 42255.99, 42250.12, 42255.98).unwrap(),
                Candle::new(1703978700000, 42255.99, 42261.15, 42253.99, 42254.00).unwrap(),
                Candle::new(1703978760000, 42253.99, 42254.00, 42242.00, 42245.86).unwrap(),
                Candle::new(1703978820000, 42245.85, 42245.86, 42244.86, 42244.86).unwrap(),
                Candle::new(1703978880000, 42244.87, 42244.87, 42242.00, 42242.00).unwrap(),
                Candle::new(1703978940000, 42242.00, 42242.01, 42242.00, 42242.01).unwrap(),
                Candle::new(1703979000000, 42242.00, 42242.01, 42225.00, 42225.01).unwrap(),
                Candle::new(1703979060000, 42225.00, 42238.36, 42225.00, 42238.35).unwrap(),
                Candle::new(1703979120000, 42238.36, 42260.00, 42238.35, 42254.49).unwrap(),
                Candle::new(1703979180000, 42254.48, 42254.49, 42233.37, 42243.55).unwrap(),
                Candle::new(1703979240000, 42243.55, 42243.56, 42228.61, 42228.61).unwrap(),
                Candle::new(1703979300000, 42228.61, 42235.37, 42228.61, 42235.37).unwrap(),
                Candle::new(1703979360000, 42235.36, 42248.62, 42235.36, 42242.01).unwrap(),
                Candle::new(1703979420000, 42242.00, 42245.38, 42232.83, 42240.43).unwrap(),
                Candle::new(1703979480000, 42240.43, 42246.37, 42232.64, 42232.65).unwrap(),
                Candle::new(1703979540000, 42232.65, 42232.65, 42212.36, 42212.36).unwrap(),
                Candle::new(1703979600000, 42212.36, 42212.37, 42200.00, 42205.01).unwrap(),
                Candle::new(1703979660000, 42205.01, 42205.01, 42189.48, 42189.49).unwrap(),
                Candle::new(1703979720000, 42189.48, 42189.49, 42176.60, 42176.61).unwrap(),
                Candle::new(1703979780000, 42176.60, 42177.99, 42162.00, 42177.91).unwrap(),
                Candle::new(1703979840000, 42177.91, 42179.37, 42177.90, 42179.36).unwrap(),
                Candle::new(1703979900000, 42179.36, 42199.10, 42179.36, 42195.32).unwrap(),
                Candle::new(1703979960000, 42195.32, 42201.68, 42187.70, 42201.68).unwrap(),
                Candle::new(1703980020000, 42201.67, 42205.01, 42201.67, 42205.01).unwrap(),
                Candle::new(1703980080000, 42205.00, 42205.01, 42205.00, 42205.00).unwrap(),
                Candle::new(1703980140000, 42205.00, 42205.01, 42205.00, 42205.01).unwrap(),
                Candle::new(1703980200000, 42205.01, 42214.59, 42199.61, 42214.59).unwrap(),
                Candle::new(1703980260000, 42214.59, 42219.44, 42214.54, 42219.44).unwrap(),
                Candle::new(1703980320000, 42219.43, 42219.61, 42214.61, 42219.61).unwrap(),
                Candle::new(1703980380000, 42219.61, 42219.61, 42206.42, 42206.44).unwrap(),
                Candle::new(1703980440000, 42206.44, 42206.47, 42198.84, 42206.47).unwrap(),
                Candle::new(1703980500000, 42206.47, 42206.47, 42204.58, 42204.58).unwrap(),
                Candle::new(1703980560000, 42204.59, 42204.59, 42200.51, 42200.52).unwrap(),
                Candle::new(1703980620000, 42200.52, 42200.52, 42166.56, 42170.97).unwrap(),
                Candle::new(1703980680000, 42170.96, 42170.97, 42133.95, 42136.97).unwrap(),
                Candle::new(1703980740000, 42136.98, 42140.29, 42136.97, 42140.28).unwrap(),
                Candle::new(1703980800000, 42140.29, 42168.00, 42140.28, 42167.99).unwrap(),
                Candle::new(1703980860000, 42167.99, 42171.10, 42167.99, 42171.09).unwrap(),
                Candle::new(1703980920000, 42171.10, 42195.31, 42171.09, 42195.31).unwrap(),
                Candle::new(1703980980000, 42195.31, 42201.96, 42195.30, 42198.30).unwrap(),
                Candle::new(1703981040000, 42198.30, 42206.12, 42195.47, 42206.12).unwrap(),
                Candle::new(1703981100000, 42206.11, 42206.12, 42197.54, 42201.97).unwrap(),
                Candle::new(1703981160000, 42201.98, 42201.98, 42161.98, 42161.98).unwrap(),
                Candle::new(1703981220000, 42161.99, 42178.15, 42144.67, 42177.56).unwrap(),
                Candle::new(1703981280000, 42177.55, 42193.14, 42174.14, 42193.13).unwrap(),
                Candle::new(1703981340000, 42193.14, 42198.06, 42193.13, 42198.06).unwrap(),
                Candle::new(1703981400000, 42198.05, 42207.65, 42198.05, 42207.65).unwrap(),
                Candle::new(1703981460000, 42207.65, 42278.66, 42207.64, 42276.03).unwrap(),
                Candle::new(1703981520000, 42276.03, 42276.04, 42262.53, 42262.54).unwrap(),
                Candle::new(1703981580000, 42262.54, 42262.54, 42251.61, 42251.62).unwrap(),
                Candle::new(1703981640000, 42251.62, 42257.86, 42251.61, 42257.85).unwrap(),
                Candle::new(1703981700000, 42257.86, 42285.56, 42257.85, 42276.23).unwrap(),
                Candle::new(1703981760000, 42276.23, 42344.02, 42272.92, 42311.11).unwrap(),
                Candle::new(1703981820000, 42311.11, 42355.46, 42311.10, 42339.17).unwrap(),
                Candle::new(1703981880000, 42339.18, 42344.68, 42313.72, 42313.72).unwrap(),
                Candle::new(1703981940000, 42313.73, 42329.73, 42311.11, 42318.00).unwrap(),
                Candle::new(1703982000000, 42318.01, 42321.10, 42309.63, 42312.02).unwrap(),
                Candle::new(1703982060000, 42312.01, 42312.02, 42300.11, 42306.49).unwrap(),
                Candle::new(1703982120000, 42306.48, 42311.10, 42294.55, 42308.00).unwrap(),
                Candle::new(1703982180000, 42308.00, 42308.01, 42291.10, 42291.11).unwrap(),
                Candle::new(1703982240000, 42291.11, 42300.00, 42282.07, 42282.21).unwrap(),
                Candle::new(1703982300000, 42282.21, 42290.00, 42261.10, 42264.00).unwrap(),
                Candle::new(1703982360000, 42264.00, 42264.00, 42243.35, 42243.35).unwrap(),
                Candle::new(1703982420000, 42243.35, 42243.36, 42243.35, 42243.35).unwrap(),
                Candle::new(1703982480000, 42243.35, 42255.78, 42243.35, 42254.01).unwrap(),
                Candle::new(1703982540000, 42253.98, 42255.78, 42252.02, 42255.78).unwrap(),
                Candle::new(1703982600000, 42255.78, 42255.81, 42247.30, 42247.31).unwrap(),
                Candle::new(1703982660000, 42247.31, 42247.31, 42239.41, 42245.42).unwrap(),
                Candle::new(1703982720000, 42245.41, 42267.94, 42245.41, 42249.91).unwrap(),
                Candle::new(1703982780000, 42249.90, 42260.00, 42249.90, 42260.00).unwrap(),
                Candle::new(1703982840000, 42259.99, 42274.00, 42259.99, 42268.00).unwrap(),
                Candle::new(1703982900000, 42268.00, 42343.65, 42268.00, 42340.01).unwrap(),
                Candle::new(1703982960000, 42340.00, 42358.79, 42335.93, 42351.44).unwrap(),
                Candle::new(1703983020000, 42351.45, 42373.56, 42321.48, 42373.56).unwrap(),
                Candle::new(1703983080000, 42373.56, 42429.64, 42368.06, 42396.01).unwrap(),
                Candle::new(1703983140000, 42396.01, 42396.01, 42368.01, 42368.01).unwrap(),
                Candle::new(1703983200000, 42368.02, 42368.02, 42339.76, 42362.34).unwrap(),
                Candle::new(1703983260000, 42362.33, 42377.42, 42362.33, 42372.54).unwrap(),
                Candle::new(1703983320000, 42372.53, 42376.47, 42362.34, 42362.35).unwrap(),
                Candle::new(1703983380000, 42362.35, 42362.35, 42348.10, 42361.10).unwrap(),
                Candle::new(1703983440000, 42361.09, 42371.10, 42358.56, 42358.56).unwrap(),
                Candle::new(1703983500000, 42358.57, 42401.58, 42355.69, 42368.56).unwrap(),
                Candle::new(1703983560000, 42368.56, 42368.56, 42334.09, 42334.09).unwrap(),
                Candle::new(1703983620000, 42334.10, 42346.35, 42331.06, 42346.01).unwrap(),
                Candle::new(1703983680000, 42346.02, 42346.02, 42334.32, 42346.02).unwrap(),
                Candle::new(1703983740000, 42346.01, 42346.02, 42331.18, 42331.19).unwrap(),
                Candle::new(1703983800000, 42331.19, 42331.19, 42324.07, 42326.31).unwrap(),
                Candle::new(1703983860000, 42326.31, 42326.32, 42316.11, 42316.36).unwrap(),
                Candle::new(1703983920000, 42316.37, 42316.37, 42315.96, 42315.97).unwrap(),
                Candle::new(1703983980000, 42315.96, 42363.03, 42315.96, 42361.10).unwrap(),
                Candle::new(1703984040000, 42361.10, 42361.10, 42343.21, 42356.85).unwrap(),
                Candle::new(1703984100000, 42356.85, 42356.85, 42356.84, 42356.84).unwrap(),
                Candle::new(1703984160000, 42356.85, 42356.85, 42346.26, 42346.26).unwrap(),
                Candle::new(1703984220000, 42346.27, 42346.27, 42334.63, 42334.63).unwrap(),
                Candle::new(1703984280000, 42334.63, 42341.06, 42330.30, 42333.25).unwrap(),
                Candle::new(1703984340000, 42333.25, 42371.06, 42333.24, 42367.87).unwrap(),
                Candle::new(1703984400000, 42367.87, 42433.49, 42367.87, 42430.33).unwrap(),
                Candle::new(1703984460000, 42430.34, 42430.34, 42395.26, 42395.26).unwrap(),
                Candle::new(1703984520000, 42395.26, 42409.66, 42383.82, 42409.66).unwrap(),
                Candle::new(1703984580000, 42409.65, 42411.10, 42387.98, 42387.99).unwrap(),
                Candle::new(1703984640000, 42387.99, 42387.99, 42362.38, 42373.82).unwrap(),
                Candle::new(1703984700000, 42373.82, 42373.82, 42370.44, 42370.44).unwrap(),
                Candle::new(1703984760000, 42370.44, 42370.45, 42361.10, 42364.20).unwrap(),
                Candle::new(1703984820000, 42364.20, 42378.00, 42358.49, 42366.53).unwrap(),
                Candle::new(1703984880000, 42366.54, 42366.54, 42356.00, 42356.01).unwrap(),
                Candle::new(1703984940000, 42356.00, 42356.01, 42346.52, 42346.53).unwrap(),
                Candle::new(1703985000000, 42346.52, 42346.53, 42341.86, 42341.87).unwrap(),
                Candle::new(1703985060000, 42341.87, 42341.87, 42333.24, 42338.97).unwrap(),
                Candle::new(1703985120000, 42338.97, 42357.55, 42338.97, 42357.54).unwrap(),
                Candle::new(1703985180000, 42357.55, 42381.10, 42357.54, 42362.01).unwrap(),
                Candle::new(1703985240000, 42362.00, 42362.01, 42344.70, 42344.70).unwrap(),
                Candle::new(1703985300000, 42344.71, 42344.71, 42324.60, 42324.60).unwrap(),
                Candle::new(1703985360000, 42324.61, 42324.61, 42314.28, 42320.56).unwrap(),
                Candle::new(1703985420000, 42320.57, 42340.34, 42307.59, 42340.33).unwrap(),
                Candle::new(1703985480000, 42340.34, 42340.34, 42311.16, 42325.33).unwrap(),
                Candle::new(1703985540000, 42325.32, 42325.33, 42309.47, 42309.48).unwrap(),
                Candle::new(1703985600000, 42309.47, 42325.14, 42307.59, 42307.59).unwrap(),
                Candle::new(1703985660000, 42307.60, 42307.60, 42307.55, 42307.55).unwrap(),
                Candle::new(1703985720000, 42307.55, 42307.63, 42301.11, 42301.85).unwrap(),
                Candle::new(1703985780000, 42301.86, 42307.63, 42297.22, 42298.61).unwrap(),
                Candle::new(1703985840000, 42298.60, 42311.61, 42298.60, 42311.60).unwrap(),
                Candle::new(1703985900000, 42311.60, 42311.61, 42296.62, 42296.62).unwrap(),
                Candle::new(1703985960000, 42296.62, 42296.63, 42290.00, 42290.00).unwrap(),
                Candle::new(1703986020000, 42290.01, 42294.50, 42290.00, 42294.49).unwrap(),
                Candle::new(1703986080000, 42294.50, 42294.50, 42290.00, 42290.01).unwrap(),
                Candle::new(1703986140000, 42290.01, 42293.23, 42288.20, 42288.20).unwrap(),
                Candle::new(1703986200000, 42288.20, 42288.21, 42274.23, 42276.85).unwrap(),
                Candle::new(1703986260000, 42276.84, 42280.47, 42260.00, 42261.10).unwrap(),
                Candle::new(1703986320000, 42261.10, 42279.47, 42261.10, 42275.94).unwrap(),
                Candle::new(1703986380000, 42275.95, 42280.47, 42263.74, 42280.47).unwrap(),
                Candle::new(1703986440000, 42280.47, 42283.44, 42268.00, 42268.37).unwrap(),
                Candle::new(1703986500000, 42268.37, 42268.37, 42265.66, 42265.66).unwrap(),
                Candle::new(1703986560000, 42265.66, 42265.67, 42255.00, 42255.00).unwrap(),
                Candle::new(1703986620000, 42255.00, 42255.01, 42241.76, 42241.76).unwrap(),
                Candle::new(1703986680000, 42241.77, 42241.80, 42241.76, 42241.80).unwrap(),
                Candle::new(1703986740000, 42241.79, 42241.80, 42228.36, 42228.36).unwrap(),
                Candle::new(1703986800000, 42228.37, 42236.00, 42228.36, 42235.99).unwrap(),
                Candle::new(1703986860000, 42235.99, 42236.00, 42221.10, 42221.10).unwrap(),
                Candle::new(1703986920000, 42221.11, 42221.11, 42210.37, 42210.38).unwrap(),
                Candle::new(1703986980000, 42210.37, 42210.38, 42165.84, 42165.84).unwrap(),
                Candle::new(1703987040000, 42165.85, 42180.37, 42165.84, 42180.37).unwrap(),
                Candle::new(1703987100000, 42180.36, 42208.62, 42180.36, 42208.62).unwrap(),
                Candle::new(1703987160000, 42208.62, 42211.96, 42205.86, 42210.74).unwrap(),
                Candle::new(1703987220000, 42210.74, 42210.74, 42199.69, 42199.70).unwrap(),
                Candle::new(1703987280000, 42199.70, 42204.00, 42199.69, 42201.74).unwrap(),
                Candle::new(1703987340000, 42201.74, 42201.74, 42195.09, 42197.54).unwrap(),
                Candle::new(1703987400000, 42197.55, 42211.10, 42197.54, 42211.09).unwrap(),
                Candle::new(1703987460000, 42211.10, 42212.62, 42206.00, 42206.01).unwrap(),
                Candle::new(1703987520000, 42206.01, 42211.59, 42197.78, 42211.57).unwrap(),
                Candle::new(1703987580000, 42211.57, 42213.11, 42206.80, 42213.11).unwrap(),
                Candle::new(1703987640000, 42213.10, 42227.93, 42210.00, 42224.62).unwrap(),
                Candle::new(1703987700000, 42224.62, 42224.62, 42207.00, 42207.00).unwrap(),
                Candle::new(1703987760000, 42207.00, 42207.01, 42201.04, 42201.05).unwrap(),
                Candle::new(1703987820000, 42201.05, 42201.05, 42193.88, 42194.71).unwrap(),
                Candle::new(1703987880000, 42194.70, 42194.71, 42156.59, 42163.96).unwrap(),
                Candle::new(1703987940000, 42163.96, 42170.63, 42163.95, 42170.63).unwrap(),
                Candle::new(1703988000000, 42170.62, 42185.32, 42170.58, 42180.12).unwrap(),
                Candle::new(1703988060000, 42180.12, 42192.75, 42171.11, 42190.64).unwrap(),
                Candle::new(1703988120000, 42190.64, 42192.75, 42190.58, 42190.59).unwrap(),
                Candle::new(1703988180000, 42190.59, 42193.39, 42181.65, 42193.39).unwrap(),
                Candle::new(1703988240000, 42193.38, 42193.39, 42181.10, 42181.59).unwrap(),
                Candle::new(1703988300000, 42181.60, 42198.00, 42181.59, 42197.99).unwrap(),
                Candle::new(1703988360000, 42197.99, 42216.00, 42197.99, 42216.00).unwrap(),
                Candle::new(1703988420000, 42215.99, 42236.00, 42215.99, 42235.96).unwrap(),
                Candle::new(1703988480000, 42235.95, 42235.96, 42231.09, 42231.10).unwrap(),
                Candle::new(1703988540000, 42231.09, 42231.10, 42214.01, 42214.01).unwrap(),
                Candle::new(1703988600000, 42214.02, 42214.02, 42204.55, 42210.26).unwrap(),
                Candle::new(1703988660000, 42210.27, 42217.08, 42210.26, 42217.07).unwrap(),
                Candle::new(1703988720000, 42217.07, 42226.00, 42217.07, 42225.99).unwrap(),
                Candle::new(1703988780000, 42225.99, 42226.00, 42225.99, 42225.99).unwrap(),
                Candle::new(1703988840000, 42226.00, 42226.00, 42225.99, 42226.00).unwrap(),
                Candle::new(1703988900000, 42226.00, 42237.11, 42208.00, 42208.95).unwrap(),
                Candle::new(1703988960000, 42208.94, 42208.95, 42207.96, 42207.97).unwrap(),
                Candle::new(1703989020000, 42207.97, 42207.97, 42204.55, 42204.56).unwrap(),
                Candle::new(1703989080000, 42204.56, 42222.24, 42204.55, 42213.51).unwrap(),
                Candle::new(1703989140000, 42213.51, 42218.00, 42213.50, 42217.99).unwrap(),
                Candle::new(1703989200000, 42217.99, 42218.00, 42217.99, 42218.00).unwrap(),
                Candle::new(1703989260000, 42217.99, 42218.00, 42217.99, 42217.99).unwrap(),
                Candle::new(1703989320000, 42218.00, 42218.00, 42217.99, 42217.99).unwrap(),
                Candle::new(1703989380000, 42218.00, 42218.00, 42204.55, 42204.56).unwrap(),
                Candle::new(1703989440000, 42204.56, 42204.56, 42172.80, 42172.81).unwrap(),
                Candle::new(1703989500000, 42172.80, 42183.65, 42168.01, 42183.65).unwrap(),
                Candle::new(1703989560000, 42183.64, 42194.00, 42183.64, 42191.52).unwrap(),
                Candle::new(1703989620000, 42191.51, 42191.52, 42191.51, 42191.51).unwrap(),
                Candle::new(1703989680000, 42191.51, 42198.00, 42191.51, 42198.00).unwrap(),
                Candle::new(1703989740000, 42197.99, 42198.00, 42197.99, 42197.99).unwrap(),
                Candle::new(1703989800000, 42198.00, 42205.99, 42176.82, 42177.58).unwrap(),
                Candle::new(1703989860000, 42177.58, 42177.59, 42154.58, 42154.58).unwrap(),
                Candle::new(1703989920000, 42154.59, 42176.00, 42154.58, 42175.99).unwrap(),
                Candle::new(1703989980000, 42175.99, 42176.00, 42152.00, 42152.01).unwrap(),
                Candle::new(1703990040000, 42152.00, 42152.01, 42141.10, 42141.11).unwrap(),
                Candle::new(1703990100000, 42141.10, 42141.11, 42121.59, 42124.23).unwrap(),
                Candle::new(1703990160000, 42124.23, 42133.02, 42100.00, 42133.02).unwrap(),
                Candle::new(1703990220000, 42133.01, 42145.84, 42117.68, 42127.99).unwrap(),
                Candle::new(1703990280000, 42127.99, 42138.71, 42127.99, 42138.71).unwrap(),
                Candle::new(1703990340000, 42138.70, 42138.71, 42016.00, 42055.30).unwrap(),
                Candle::new(1703990400000, 42055.30, 42094.91, 42051.11, 42094.01).unwrap(),
                Candle::new(1703990460000, 42094.02, 42119.99, 42094.01, 42109.65).unwrap(),
                Candle::new(1703990520000, 42109.64, 42112.02, 42102.00, 42112.02).unwrap(),
                Candle::new(1703990580000, 42112.02, 42112.02, 42100.91, 42104.31).unwrap(),
                Candle::new(1703990640000, 42104.30, 42104.31, 42058.00, 42074.29).unwrap(),
                Candle::new(1703990700000, 42074.29, 42086.95, 42068.84, 42073.99).unwrap(),
                Candle::new(1703990760000, 42073.99, 42074.00, 42017.09, 42037.90).unwrap(),
                Candle::new(1703990820000, 42037.90, 42037.90, 42007.00, 42007.00).unwrap(),
                Candle::new(1703990880000, 42007.01, 42020.22, 42007.00, 42009.82).unwrap(),
                Candle::new(1703990940000, 42009.82, 42020.00, 42000.00, 42000.00).unwrap(),
                Candle::new(1703991000000, 42000.00, 42006.00, 42000.00, 42000.00).unwrap(),
                Candle::new(1703991060000, 42000.01, 42000.01, 41988.77, 41994.00).unwrap(),
                Candle::new(1703991120000, 41993.99, 42001.09, 41990.48, 41996.03).unwrap(),
                Candle::new(1703991180000, 41996.03, 42028.10, 41965.84, 42028.09).unwrap(),
                Candle::new(1703991240000, 42028.10, 42037.08, 42006.44, 42031.13).unwrap(),
                Candle::new(1703991300000, 42031.13, 42046.84, 42031.09, 42046.84).unwrap(),
                Candle::new(1703991360000, 42046.84, 42046.84, 42038.01, 42039.98).unwrap(),
                Candle::new(1703991420000, 42039.99, 42067.18, 42039.98, 42067.18).unwrap(),
                Candle::new(1703991480000, 42067.17, 42094.00, 42067.17, 42094.00).unwrap(),
                Candle::new(1703991540000, 42094.00, 42094.00, 42084.47, 42084.48).unwrap(),
                Candle::new(1703991600000, 42084.48, 42100.00, 42074.91, 42096.10).unwrap(),
                Candle::new(1703991660000, 42096.10, 42096.10, 42081.30, 42096.09).unwrap(),
                Candle::new(1703991720000, 42096.09, 42113.32, 42090.74, 42108.01).unwrap(),
                Candle::new(1703991780000, 42108.02, 42120.00, 42108.01, 42112.28).unwrap(),
                Candle::new(1703991840000, 42112.28, 42112.28, 42106.00, 42106.01).unwrap(),
                Candle::new(1703991900000, 42106.00, 42106.01, 42090.72, 42090.73).unwrap(),
                Candle::new(1703991960000, 42090.73, 42090.73, 42074.82, 42074.82).unwrap(),
                Candle::new(1703992020000, 42074.82, 42074.83, 42066.00, 42066.01).unwrap(),
                Candle::new(1703992080000, 42066.00, 42072.02, 42062.59, 42065.72).unwrap(),
                Candle::new(1703992140000, 42065.73, 42065.73, 42054.23, 42065.00).unwrap(),
                Candle::new(1703992200000, 42064.99, 42074.01, 42056.32, 42074.00).unwrap(),
                Candle::new(1703992260000, 42074.00, 42100.00, 42074.00, 42096.93).unwrap(),
                Candle::new(1703992320000, 42096.93, 42096.93, 42084.21, 42084.22).unwrap(),
                Candle::new(1703992380000, 42084.22, 42084.22, 42078.05, 42078.05).unwrap(),
                Candle::new(1703992440000, 42078.06, 42078.06, 42056.00, 42056.01).unwrap(),
                Candle::new(1703992500000, 42056.01, 42070.00, 42042.69, 42070.00).unwrap(),
                Candle::new(1703992560000, 42070.00, 42081.00, 42069.99, 42081.00).unwrap(),
                Candle::new(1703992620000, 42081.00, 42090.00, 42073.79, 42090.00).unwrap(),
                Candle::new(1703992680000, 42089.99, 42090.00, 42048.01, 42048.01).unwrap(),
                Candle::new(1703992740000, 42048.02, 42049.99, 42041.10, 42041.10).unwrap(),
                Candle::new(1703992800000, 42041.11, 42041.11, 42026.00, 42031.99).unwrap(),
                Candle::new(1703992860000, 42032.00, 42046.00, 42031.99, 42046.00).unwrap(),
                Candle::new(1703992920000, 42045.99, 42050.00, 42045.99, 42050.00).unwrap(),
                Candle::new(1703992980000, 42049.99, 42055.00, 42049.99, 42055.00).unwrap(),
                Candle::new(1703993040000, 42055.00, 42061.10, 42043.88, 42043.89).unwrap(),
                Candle::new(1703993100000, 42043.89, 42056.11, 42042.07, 42056.11).unwrap(),
                Candle::new(1703993160000, 42056.10, 42058.00, 42056.10, 42057.99).unwrap(),
                Candle::new(1703993220000, 42057.99, 42070.00, 42057.99, 42062.39).unwrap(),
                Candle::new(1703993280000, 42062.40, 42062.40, 42046.44, 42046.45).unwrap(),
                Candle::new(1703993340000, 42046.44, 42046.45, 42046.44, 42046.44).unwrap(),
                Candle::new(1703993400000, 42046.45, 42077.66, 42046.44, 42077.65).unwrap(),
                Candle::new(1703993460000, 42077.66, 42085.00, 42067.29, 42085.00).unwrap(),
                Candle::new(1703993520000, 42084.99, 42091.10, 42084.99, 42091.10).unwrap(),
                Candle::new(1703993580000, 42091.10, 42097.33, 42081.10, 42097.33).unwrap(),
                Candle::new(1703993640000, 42097.32, 42100.00, 42078.23, 42100.00).unwrap(),
                Candle::new(1703993700000, 42099.99, 42100.00, 42099.00, 42099.00).unwrap(),
                Candle::new(1703993760000, 42099.01, 42099.01, 42083.15, 42083.15).unwrap(),
                Candle::new(1703993820000, 42083.15, 42095.53, 42083.15, 42095.49).unwrap(),
                Candle::new(1703993880000, 42095.48, 42104.98, 42095.48, 42104.97).unwrap(),
                Candle::new(1703993940000, 42104.97, 42104.98, 42100.00, 42100.01).unwrap(),
                Candle::new(1703994000000, 42100.00, 42104.00, 42091.10, 42104.00).unwrap(),
                Candle::new(1703994060000, 42104.00, 42111.10, 42098.00, 42111.10).unwrap(),
                Candle::new(1703994120000, 42111.10, 42115.00, 42111.09, 42114.99).unwrap(),
                Candle::new(1703994180000, 42114.99, 42119.60, 42106.94, 42115.36).unwrap(),
                Candle::new(1703994240000, 42115.36, 42160.40, 42115.35, 42153.26).unwrap(),
                Candle::new(1703994300000, 42153.27, 42178.01, 42153.26, 42177.96).unwrap(),
                Candle::new(1703994360000, 42177.97, 42186.03, 42168.00, 42168.00).unwrap(),
                Candle::new(1703994420000, 42168.01, 42168.01, 42151.10, 42151.10).unwrap(),
                Candle::new(1703994480000, 42151.10, 42151.11, 42132.02, 42132.02).unwrap(),
                Candle::new(1703994540000, 42132.02, 42140.00, 42132.02, 42138.02).unwrap(),
                Candle::new(1703994600000, 42138.03, 42145.83, 42138.02, 42145.76).unwrap(),
                Candle::new(1703994660000, 42145.75, 42145.76, 42138.03, 42138.03).unwrap(),
                Candle::new(1703994720000, 42138.04, 42138.04, 42122.07, 42126.01).unwrap(),
                Candle::new(1703994780000, 42126.01, 42126.01, 42124.00, 42124.01).unwrap(),
                Candle::new(1703994840000, 42124.00, 42124.04, 42124.00, 42124.04).unwrap(),
                Candle::new(1703994900000, 42124.04, 42139.60, 42124.03, 42138.00).unwrap(),
                Candle::new(1703994960000, 42137.99, 42138.00, 42134.01, 42134.02).unwrap(),
                Candle::new(1703995020000, 42134.02, 42168.68, 42134.01, 42168.68).unwrap(),
                Candle::new(1703995080000, 42168.67, 42170.79, 42168.67, 42170.79).unwrap(),
                Candle::new(1703995140000, 42170.78, 42176.00, 42170.78, 42176.00).unwrap(),
                Candle::new(1703995200000, 42175.99, 42176.00, 42169.50, 42171.28).unwrap(),
                Candle::new(1703995260000, 42171.28, 42171.29, 42161.06, 42161.06).unwrap(),
                Candle::new(1703995320000, 42161.07, 42161.07, 42156.85, 42156.85).unwrap(),
                Candle::new(1703995380000, 42156.86, 42156.86, 42156.09, 42156.09).unwrap(),
                Candle::new(1703995440000, 42156.10, 42156.10, 42156.09, 42156.09).unwrap(),
                Candle::new(1703995500000, 42156.10, 42181.10, 42156.09, 42181.10).unwrap(),
                Candle::new(1703995560000, 42181.09, 42217.32, 42181.09, 42204.08).unwrap(),
                Candle::new(1703995620000, 42204.08, 42207.70, 42192.02, 42192.03).unwrap(),
                Candle::new(1703995680000, 42192.02, 42192.03, 42181.10, 42181.10).unwrap(),
                Candle::new(1703995740000, 42181.11, 42215.68, 42176.21, 42214.16).unwrap(),
                Candle::new(1703995800000, 42214.17, 42231.98, 42214.16, 42224.85).unwrap(),
                Candle::new(1703995860000, 42224.84, 42224.85, 42224.80, 42224.81).unwrap(),
                Candle::new(1703995920000, 42224.80, 42224.81, 42220.00, 42220.01).unwrap(),
                Candle::new(1703995980000, 42220.00, 42229.49, 42220.00, 42228.90).unwrap(),
                Candle::new(1703996040000, 42228.90, 42230.04, 42228.89, 42230.03).unwrap(),
                Candle::new(1703996100000, 42230.04, 42230.04, 42222.32, 42222.33).unwrap(),
                Candle::new(1703996160000, 42222.32, 42246.92, 42222.32, 42246.92).unwrap(),
                Candle::new(1703996220000, 42246.91, 42250.40, 42240.00, 42240.01).unwrap(),
                Candle::new(1703996280000, 42240.00, 42240.01, 42232.13, 42233.54).unwrap(),
                Candle::new(1703996340000, 42233.54, 42269.28, 42233.53, 42266.95).unwrap(),
                Candle::new(1703996400000, 42266.95, 42277.43, 42249.55, 42249.55).unwrap(),
                Candle::new(1703996460000, 42249.56, 42262.40, 42246.69, 42262.39).unwrap(),
                Candle::new(1703996520000, 42262.39, 42270.00, 42262.39, 42264.00).unwrap(),
                Candle::new(1703996580000, 42264.01, 42264.01, 42251.88, 42251.88).unwrap(),
                Candle::new(1703996640000, 42251.88, 42263.29, 42251.88, 42263.29).unwrap(),
                Candle::new(1703996700000, 42263.28, 42288.24, 42263.28, 42288.23).unwrap(),
                Candle::new(1703996760000, 42288.23, 42288.24, 42261.10, 42261.11).unwrap(),
                Candle::new(1703996820000, 42261.10, 42261.11, 42261.06, 42261.06).unwrap(),
                Candle::new(1703996880000, 42261.06, 42298.01, 42261.06, 42298.01).unwrap(),
                Candle::new(1703996940000, 42298.01, 42298.01, 42292.00, 42292.00).unwrap(),
                Candle::new(1703997000000, 42292.01, 42325.66, 42292.00, 42296.71).unwrap(),
                Candle::new(1703997060000, 42296.70, 42300.00, 42294.57, 42294.58).unwrap(),
                Candle::new(1703997120000, 42294.59, 42294.59, 42282.00, 42282.00).unwrap(),
                Candle::new(1703997180000, 42282.00, 42282.01, 42282.00, 42282.01).unwrap(),
                Candle::new(1703997240000, 42282.00, 42282.01, 42260.98, 42260.99).unwrap(),
                Candle::new(1703997300000, 42260.98, 42275.18, 42255.01, 42261.11).unwrap(),
                Candle::new(1703997360000, 42261.11, 42261.11, 42252.16, 42252.16).unwrap(),
                Candle::new(1703997420000, 42252.16, 42260.00, 42243.25, 42243.55).unwrap(),
                Candle::new(1703997480000, 42243.55, 42253.44, 42242.46, 42243.53).unwrap(),
                Candle::new(1703997540000, 42243.54, 42243.54, 42225.69, 42230.55).unwrap(),
                Candle::new(1703997600000, 42230.55, 42238.16, 42228.61, 42228.61).unwrap(),
                Candle::new(1703997660000, 42228.62, 42228.62, 42220.00, 42220.00).unwrap(),
                Candle::new(1703997720000, 42220.01, 42231.10, 42220.00, 42231.09).unwrap(),
                Candle::new(1703997780000, 42231.09, 42231.10, 42222.55, 42222.56).unwrap(),
                Candle::new(1703997840000, 42222.55, 42224.67, 42219.12, 42224.66).unwrap(),
                Candle::new(1703997900000, 42224.66, 42224.67, 42220.00, 42220.04).unwrap(),
                Candle::new(1703997960000, 42220.04, 42220.04, 42220.03, 42220.04).unwrap(),
                Candle::new(1703998020000, 42220.04, 42220.04, 42212.54, 42212.55).unwrap(),
                Candle::new(1703998080000, 42212.54, 42214.00, 42208.95, 42208.95).unwrap(),
                Candle::new(1703998140000, 42208.95, 42208.96, 42208.95, 42208.96).unwrap(),
                Candle::new(1703998200000, 42208.95, 42211.25, 42208.95, 42210.01).unwrap(),
                Candle::new(1703998260000, 42210.01, 42210.01, 42202.64, 42202.65).unwrap(),
                Candle::new(1703998320000, 42202.65, 42202.65, 42200.00, 42200.00).unwrap(),
                Candle::new(1703998380000, 42200.00, 42200.01, 42185.43, 42188.18).unwrap(),
                Candle::new(1703998440000, 42188.19, 42205.83, 42188.18, 42194.01).unwrap(),
                Candle::new(1703998500000, 42194.01, 42229.21, 42194.01, 42229.21).unwrap(),
                Candle::new(1703998560000, 42229.21, 42231.67, 42226.31, 42226.67).unwrap(),
                Candle::new(1703998620000, 42226.67, 42226.67, 42218.61, 42223.03).unwrap(),
                Candle::new(1703998680000, 42223.02, 42223.03, 42220.00, 42220.00).unwrap(),
                Candle::new(1703998740000, 42220.00, 42227.60, 42220.00, 42226.29).unwrap(),
                Candle::new(1703998800000, 42226.29, 42226.29, 42220.00, 42220.01).unwrap(),
                Candle::new(1703998860000, 42220.01, 42220.01, 42220.00, 42220.00).unwrap(),
                Candle::new(1703998920000, 42220.01, 42220.01, 42212.00, 42212.49).unwrap(),
                Candle::new(1703998980000, 42212.48, 42214.20, 42210.00, 42214.19).unwrap(),
                Candle::new(1703999040000, 42214.19, 42214.20, 42210.04, 42214.18).unwrap(),
                Candle::new(1703999100000, 42214.17, 42243.54, 42214.17, 42243.54).unwrap(),
                Candle::new(1703999160000, 42243.53, 42270.08, 42243.53, 42270.07).unwrap(),
                Candle::new(1703999220000, 42270.08, 42270.08, 42262.00, 42262.01).unwrap(),
                Candle::new(1703999280000, 42262.01, 42262.01, 42260.00, 42260.01).unwrap(),
                Candle::new(1703999340000, 42260.00, 42260.02, 42260.00, 42260.01).unwrap(),
                Candle::new(1703999400000, 42260.02, 42275.02, 42260.01, 42262.72).unwrap(),
                Candle::new(1703999460000, 42262.71, 42269.83, 42259.97, 42269.83).unwrap(),
                Candle::new(1703999520000, 42269.82, 42269.83, 42262.74, 42262.74).unwrap(),
                Candle::new(1703999580000, 42262.74, 42267.09, 42260.77, 42260.77).unwrap(),
                Candle::new(1703999640000, 42260.77, 42260.78, 42250.00, 42250.00).unwrap(),
                Candle::new(1703999700000, 42250.00, 42260.78, 42230.30, 42230.30).unwrap(),
                Candle::new(1703999760000, 42230.31, 42230.35, 42221.10, 42224.12).unwrap(),
                Candle::new(1703999820000, 42224.12, 42231.85, 42224.12, 42231.85).unwrap(),
                Candle::new(1703999880000, 42231.85, 42236.54, 42227.18, 42236.54).unwrap(),
                Candle::new(1703999940000, 42236.53, 42251.10, 42236.53, 42244.00).unwrap(),
                Candle::new(1704000000000, 42244.00, 42244.01, 42230.00, 42230.00).unwrap(),
                Candle::new(1704000060000, 42230.00, 42230.01, 42230.00, 42230.01).unwrap(),
                Candle::new(1704000120000, 42230.01, 42230.01, 42220.00, 42220.04).unwrap(),
                Candle::new(1704000180000, 42220.04, 42220.04, 42220.03, 42220.04).unwrap(),
                Candle::new(1704000240000, 42220.04, 42220.04, 42220.03, 42220.03).unwrap(),
                Candle::new(1704000300000, 42220.03, 42240.18, 42220.03, 42230.00).unwrap(),
                Candle::new(1704000360000, 42230.00, 42230.01, 42222.00, 42222.00).unwrap(),
                Candle::new(1704000420000, 42222.00, 42222.01, 42220.00, 42220.00).unwrap(),
                Candle::new(1704000480000, 42220.00, 42220.01, 42220.00, 42220.01).unwrap(),
                Candle::new(1704000540000, 42220.01, 42220.01, 42220.00, 42220.00).unwrap(),
                Candle::new(1704000600000, 42220.00, 42220.01, 42210.00, 42220.00).unwrap(),
                Candle::new(1704000660000, 42220.00, 42230.03, 42219.99, 42230.03).unwrap(),
                Candle::new(1704000720000, 42230.03, 42230.03, 42219.99, 42226.40).unwrap(),
                Candle::new(1704000780000, 42226.40, 42226.40, 42220.00, 42220.34).unwrap(),
                Candle::new(1704000840000, 42220.34, 42220.35, 42220.34, 42220.35).unwrap(),
                Candle::new(1704000900000, 42220.35, 42220.35, 42220.34, 42220.34).unwrap(),
                Candle::new(1704000960000, 42220.34, 42220.35, 42208.00, 42208.01).unwrap(),
                Candle::new(1704001020000, 42208.01, 42224.58, 42207.42, 42218.35).unwrap(),
                Candle::new(1704001080000, 42218.08, 42218.08, 42214.37, 42214.38).unwrap(),
                Candle::new(1704001140000, 42214.38, 42221.72, 42214.37, 42221.71).unwrap(),
                Candle::new(1704001200000, 42221.71, 42235.37, 42221.71, 42235.37).unwrap(),
                Candle::new(1704001260000, 42235.36, 42235.37, 42216.72, 42216.72).unwrap(),
                Candle::new(1704001320000, 42216.73, 42216.73, 42214.33, 42214.34).unwrap(),
                Candle::new(1704001380000, 42214.34, 42216.73, 42214.33, 42216.01).unwrap(),
                Candle::new(1704001440000, 42216.02, 42254.57, 42208.89, 42254.57).unwrap(),
                Candle::new(1704001500000, 42248.00, 42271.10, 42248.00, 42271.09).unwrap(),
                Candle::new(1704001560000, 42271.09, 42285.34, 42271.09, 42285.34).unwrap(),
                Candle::new(1704001620000, 42285.34, 42316.00, 42285.33, 42309.68).unwrap(),
                Candle::new(1704001680000, 42309.68, 42309.69, 42273.02, 42292.49).unwrap(),
                Candle::new(1704001740000, 42292.50, 42292.50, 42278.00, 42278.01).unwrap(),
                Candle::new(1704001800000, 42278.01, 42278.01, 42258.04, 42261.12).unwrap(),
                Candle::new(1704001860000, 42261.12, 42261.13, 42252.95, 42252.95).unwrap(),
                Candle::new(1704001920000, 42252.95, 42252.96, 42250.99, 42250.99).unwrap(),
                Candle::new(1704001980000, 42250.99, 42258.00, 42242.75, 42255.99).unwrap(),
                Candle::new(1704002040000, 42256.00, 42256.00, 42237.79, 42237.79).unwrap(),
                Candle::new(1704002100000, 42237.79, 42237.80, 42223.06, 42223.07).unwrap(),
                Candle::new(1704002160000, 42223.06, 42227.09, 42221.29, 42222.48).unwrap(),
                Candle::new(1704002220000, 42222.47, 42222.48, 42222.47, 42222.47).unwrap(),
                Candle::new(1704002280000, 42222.47, 42222.48, 42212.88, 42212.89).unwrap(),
                Candle::new(1704002340000, 42212.88, 42212.89, 42194.65, 42198.00).unwrap(),
                Candle::new(1704002400000, 42198.00, 42209.39, 42197.99, 42209.39).unwrap(),
                Candle::new(1704002460000, 42209.38, 42209.39, 42198.02, 42198.02).unwrap(),
                Candle::new(1704002520000, 42198.02, 42198.03, 42192.00, 42192.00).unwrap(),
                Candle::new(1704002580000, 42192.01, 42197.06, 42192.00, 42197.05).unwrap(),
                Candle::new(1704002640000, 42197.06, 42197.06, 42197.05, 42197.06).unwrap(),
                Candle::new(1704002700000, 42197.06, 42205.87, 42197.05, 42205.87).unwrap(),
                Candle::new(1704002760000, 42205.87, 42235.50, 42205.86, 42234.58).unwrap(),
                Candle::new(1704002820000, 42234.58, 42234.59, 42231.52, 42234.58).unwrap(),
                Candle::new(1704002880000, 42234.59, 42234.59, 42227.45, 42227.46).unwrap(),
                Candle::new(1704002940000, 42227.45, 42231.24, 42227.45, 42231.23).unwrap(),
                Candle::new(1704003000000, 42231.23, 42237.32, 42231.23, 42237.32).unwrap(),
                Candle::new(1704003060000, 42237.32, 42248.98, 42237.31, 42248.98).unwrap(),
                Candle::new(1704003120000, 42248.97, 42248.98, 42248.97, 42248.97).unwrap(),
                Candle::new(1704003180000, 42248.98, 42260.00, 42248.97, 42257.89).unwrap(),
                Candle::new(1704003240000, 42257.88, 42257.89, 42252.00, 42252.00).unwrap(),
                Candle::new(1704003300000, 42252.01, 42268.05, 42252.00, 42268.04).unwrap(),
                Candle::new(1704003360000, 42268.04, 42268.05, 42256.91, 42256.92).unwrap(),
                Candle::new(1704003420000, 42256.91, 42256.92, 42256.91, 42256.91).unwrap(),
                Candle::new(1704003480000, 42256.92, 42256.92, 42256.91, 42256.91).unwrap(),
                Candle::new(1704003540000, 42256.91, 42256.92, 42256.91, 42256.92).unwrap(),
                Candle::new(1704003600000, 42256.91, 42256.92, 42256.91, 42256.91).unwrap(),
                Candle::new(1704003660000, 42256.92, 42256.92, 42248.90, 42248.90).unwrap(),
                Candle::new(1704003720000, 42248.90, 42248.91, 42243.57, 42243.58).unwrap(),
                Candle::new(1704003780000, 42243.58, 42248.91, 42237.31, 42244.46).unwrap(),
                Candle::new(1704003840000, 42244.46, 42244.60, 42237.58, 42240.17).unwrap(),
                Candle::new(1704003900000, 42240.17, 42244.00, 42240.17, 42243.30).unwrap(),
                Candle::new(1704003960000, 42243.30, 42243.31, 42231.23, 42231.23).unwrap(),
                Candle::new(1704004020000, 42231.23, 42231.24, 42231.18, 42231.18).unwrap(),
                Candle::new(1704004080000, 42231.18, 42231.19, 42231.10, 42231.10).unwrap(),
                Candle::new(1704004140000, 42231.10, 42231.11, 42228.35, 42228.35).unwrap(),
                Candle::new(1704004200000, 42228.36, 42228.36, 42212.56, 42212.56).unwrap(),
                Candle::new(1704004260000, 42212.56, 42218.33, 42212.56, 42218.33).unwrap(),
                Candle::new(1704004320000, 42218.33, 42225.99, 42218.32, 42220.94).unwrap(),
                Candle::new(1704004380000, 42220.94, 42226.02, 42220.94, 42226.02).unwrap(),
                Candle::new(1704004440000, 42226.01, 42231.10, 42226.01, 42231.09).unwrap(),
                Candle::new(1704004500000, 42231.09, 42249.14, 42231.09, 42249.13).unwrap(),
                Candle::new(1704004560000, 42249.14, 42254.00, 42249.13, 42253.99).unwrap(),
                Candle::new(1704004620000, 42254.00, 42254.01, 42253.99, 42254.01).unwrap(),
                Candle::new(1704004680000, 42254.01, 42261.10, 42254.00, 42261.09).unwrap(),
                Candle::new(1704004740000, 42261.09, 42261.10, 42252.00, 42252.01).unwrap(),
                Candle::new(1704004800000, 42252.01, 42283.90, 42246.16, 42277.78).unwrap(),
                Candle::new(1704004860000, 42277.78, 42277.79, 42263.25, 42265.99).unwrap(),
                Candle::new(1704004920000, 42266.00, 42274.00, 42265.99, 42268.60).unwrap(),
                Candle::new(1704004980000, 42268.60, 42268.61, 42268.60, 42268.60).unwrap(),
                Candle::new(1704005040000, 42268.60, 42268.61, 42268.60, 42268.60).unwrap(),
                Candle::new(1704005100000, 42268.61, 42279.19, 42268.60, 42279.18).unwrap(),
                Candle::new(1704005160000, 42279.19, 42279.19, 42273.95, 42273.96).unwrap(),
                Candle::new(1704005220000, 42273.95, 42274.00, 42273.95, 42273.96).unwrap(),
                Candle::new(1704005280000, 42273.96, 42273.96, 42273.95, 42273.95).unwrap(),
                Candle::new(1704005340000, 42273.96, 42273.96, 42273.95, 42273.96).unwrap(),
                Candle::new(1704005400000, 42273.96, 42273.96, 42273.91, 42273.92).unwrap(),
                Candle::new(1704005460000, 42273.91, 42273.92, 42254.02, 42254.02).unwrap(),
                Candle::new(1704005520000, 42254.02, 42254.03, 42251.10, 42251.10).unwrap(),
                Candle::new(1704005580000, 42251.10, 42268.79, 42251.10, 42268.79).unwrap(),
                Candle::new(1704005640000, 42268.79, 42268.79, 42268.78, 42268.78).unwrap(),
                Candle::new(1704005700000, 42268.78, 42268.79, 42258.82, 42258.82).unwrap(),
                Candle::new(1704005760000, 42258.82, 42258.83, 42258.82, 42258.83).unwrap(),
                Candle::new(1704005820000, 42258.82, 42258.83, 42252.67, 42252.68).unwrap(),
                Candle::new(1704005880000, 42252.68, 42252.68, 42252.67, 42252.67).unwrap(),
                Candle::new(1704005940000, 42252.68, 42252.68, 42252.67, 42252.68).unwrap(),
                Candle::new(1704006000000, 42252.67, 42257.34, 42252.67, 42252.69).unwrap(),
                Candle::new(1704006060000, 42252.69, 42252.69, 42252.68, 42252.68).unwrap(),
                Candle::new(1704006120000, 42252.69, 42271.10, 42252.68, 42271.10).unwrap(),
                Candle::new(1704006180000, 42271.10, 42300.00, 42271.09, 42300.00).unwrap(),
                Candle::new(1704006240000, 42299.99, 42332.52, 42299.99, 42318.07).unwrap(),
                Candle::new(1704006300000, 42318.08, 42350.00, 42318.07, 42350.00).unwrap(),
                Candle::new(1704006360000, 42349.99, 42350.00, 42318.08, 42318.09).unwrap(),
                Candle::new(1704006420000, 42318.08, 42318.09, 42313.45, 42313.45).unwrap(),
                Candle::new(1704006480000, 42313.45, 42313.46, 42304.98, 42310.11).unwrap(),
                Candle::new(1704006540000, 42310.11, 42320.51, 42310.11, 42320.46).unwrap(),
                Candle::new(1704006600000, 42320.46, 42320.47, 42310.07, 42310.07).unwrap(),
                Candle::new(1704006660000, 42310.07, 42310.08, 42307.95, 42307.96).unwrap(),
                Candle::new(1704006720000, 42307.96, 42317.95, 42304.95, 42315.99).unwrap(),
                Candle::new(1704006780000, 42316.00, 42317.76, 42313.99, 42314.00).unwrap(),
                Candle::new(1704006840000, 42313.99, 42314.00, 42313.99, 42313.99).unwrap(),
            ],
            state: CandleStickChartState::default(),
        }
    }
}

fn main() -> Result<(), Box<dyn Error>> {
    // setup terminal
    enable_raw_mode()?;
    let mut stdout = io::stdout();
    execute!(stdout, EnterAlternateScreen, EnableMouseCapture)?;
    let backend = CrosstermBackend::new(stdout);
    let mut terminal = Terminal::new(backend)?;

    // create app and run it
    let tick_rate = Duration::from_millis(250);
    let app = App::new();
    let res = run_app(&mut terminal, app, tick_rate);

    // restore terminal
    disable_raw_mode()?;
    execute!(
        terminal.backend_mut(),
        LeaveAlternateScreen,
        DisableMouseCapture
    )?;
    terminal.show_cursor()?;

    if let Err(err) = res {
        println!("{err:?}");
    }

    Ok(())
}

fn run_app<B: Backend>(
    terminal: &mut Terminal<B>,
    mut app: App,
    tick_rate: Duration,
) -> io::Result<()> {
    let mut last_tick = Instant::now();
    loop {
        terminal.draw(|f| ui(f, &mut app))?;

        let timeout = tick_rate.saturating_sub(last_tick.elapsed());
        if crossterm::event::poll(timeout)? {
            if let Event::Key(key) = event::read()? {
                match key.code {
                    KeyCode::Char('q') => return Ok(()),
                    KeyCode::Left => app.state.try_move_backward(),
                    KeyCode::Right => app.state.try_move_forward(),
                    _ => {}
                }
            }
        }
        if last_tick.elapsed() >= tick_rate {
            last_tick = Instant::now();
        }
    }
}

fn ui(f: &mut Frame, app: &mut App) {
    let chart = CandleStickChart::new(Interval::OneMinute).candles(app.candles.clone());
    f.render_stateful_widget(chart, f.area(), &mut app.state);
}
